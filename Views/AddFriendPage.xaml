<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:models="clr-namespace:SocialSyncApp.Models"
             x:Class="SocialSyncApp.Views.AddFriendPage"
             Title="Find Friends"
             BackgroundColor="{AppThemeBinding Light=#FAFAFA, Dark=#0F0F0F}">

    <Grid RowDefinitions="Auto,*" Padding="15">

        <Grid Grid.Row="0" ColumnDefinitions="Auto,*,Auto" Margin="0,0,0,15">
            <Button Grid.Column="0" Text="â†" BackgroundColor="Transparent" TextColor="{AppThemeBinding Light=Black, Dark=White}" 
                    FontSize="24" Clicked="OnBackClicked" WidthRequest="40" Padding="0"/>

            <Label Grid.Column="1" Text="Find People" FontSize="20" FontAttributes="Bold" 
                   VerticalOptions="Center" HorizontalOptions="Center" TextColor="{AppThemeBinding Light=Black, Dark=White}"/>
        </Grid>

        <ActivityIndicator Grid.Row="1" x:Name="LoadingSpinner" IsRunning="True" IsVisible="True" 
                           Color="#6200EA" HorizontalOptions="Center" VerticalOptions="Center"/>

        <CollectionView Grid.Row="1" x:Name="UsersCollectionView" SelectionMode="None">
            <CollectionView.ItemsLayout>
                <LinearItemsLayout Orientation="Vertical" ItemSpacing="12"/>
            </CollectionView.ItemsLayout>

            <CollectionView.EmptyView>
                <VerticalStackLayout HorizontalOptions="Center" VerticalOptions="Center" Spacing="10">
                    <Label Text="ðŸ”" FontSize="40" HorizontalOptions="Center"/>
                    <Label Text="No new users found." TextColor="Gray" HorizontalOptions="Center"/>
                </VerticalStackLayout>
            </CollectionView.EmptyView>

            <CollectionView.ItemTemplate>
                <DataTemplate x:DataType="models:User">
                    <Frame Padding="15" CornerRadius="12" HasShadow="True" 
                           BorderColor="{AppThemeBinding Light=#E0E0E0, Dark=#333}"
                           BackgroundColor="{AppThemeBinding Light=White, Dark=#1E1E1E}">

                        <Grid ColumnDefinitions="50,*,Auto" ColumnSpacing="15">

                            <Frame Grid.Column="0" CornerRadius="25" Padding="0" WidthRequest="50" HeightRequest="50" 
                                   IsClippedToBounds="True" HasShadow="False" BackgroundColor="#E0E0E0">
                                <Label Text="{Binding FullName, Converter={StaticResource StringFirstCharConverter}}" 
                                       HorizontalOptions="Center" VerticalOptions="Center" 
                                       FontSize="20" FontAttributes="Bold" TextColor="#555"/>
                            </Frame>

                            <VerticalStackLayout Grid.Column="1" VerticalOptions="Center" Spacing="2">
                                <Label Text="{Binding FullName}" FontSize="16" FontAttributes="Bold" 
                                       TextColor="{AppThemeBinding Light=Black, Dark=White}"/>
                                <Label Text="{Binding Email}" FontSize="12" TextColor="Gray"/>
                            </VerticalStackLayout>

                            <Button Grid.Column="2" 
                                    Text="+ Add" 
                                    FontSize="13"
                                    FontAttributes="Bold"
                                    BackgroundColor="#6200EA" 
                                    TextColor="White" 
                                    CornerRadius="8" 
                                    HeightRequest="36"
                                    Clicked="OnAddUserClicked"
                                    CommandParameter="{Binding .}"/>
                        </Grid>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

    </Grid>
</ContentPage>